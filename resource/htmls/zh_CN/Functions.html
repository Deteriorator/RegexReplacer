<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<META http-equiv="Content-Type" content="text/html; charset=utf-8">
<TITLE>
函数说明
</TITLE>

<META NAME="date" CONTENT="2013-07-16">

</HEAD>

<BODY BGCOLOR="lightgray">
<p><b>说明：</b>如果一个函数在参数相同时，总是返回相同的值，则称之为“静态函数”，如Add、Char、ParseLong等，否则称之为“动态函数”，如Seq、AbsRow、Ref、StcRef等。
<hr>
<p>
<b>函数：Add</b><br>
<b>别名：</b>+<br>
<b>参数：</b>数字<br>
<b>个数：</b>大于等于1<br>
<b>功能：</b>返回所有参数的和<br>
<hr>
<p>
<b>函数：Subtract</b><br>
<b>别名：</b>-<br>
<b>参数：</b>数字<br>
<b>个数：</b>2<br>
<b>功能：</b>返回两个参数的差<br>
<hr>
<p>
<b>函数：Multiply</b><br>
<b>别名：</b>*<br>
<b>参数：</b>数字<br>
<b>个数：</b>大于等于1<br>
<b>功能：</b>返回所有参数的积<br>
<hr>
<p>
<b>函数：Divide</b><br>
<b>别名：</b>/<br>
<b>参数：</b>数字<br>
<b>个数：</b>2<br>
<b>功能：</b>返回两个参数的商<br>
<hr>
<p>
<b>函数：Mod</b><br>
<b>别名：</b>%<br>
<b>参数：</b>数字，允许是小数<br>
<b>个数：</b>2<br>
<b>功能：</b>返回两个参数的模<br>
<hr>
<p>
<b>函数：Char</b><br>
<b>参数：</b>整数<br>
<b>个数：</b>1<br>
<b>功能：</b>将10进制的Unicode数值转换为字符<br>
<hr>
<p>
<b>函数：Asc</b><br>
<b>参数：</b>字符或任意非null值（转换成字符串取第一个字符）<br>
<b>个数：</b>1<br>
<b>功能：</b>将字符转换为10进制的Unicode数值<br>
<hr>
<p>
<b>函数：ParseLong</b><br>
<b>参数：</b>第二个参数为数字<br>
<b>个数：</b>1或者2<br>
<b>功能：</b>将字符转解析成整数（如果有第二个参数，则以它为基数，否则以10为基数）<br>
<hr>
<p>
<b>函数：Nvl</b><br>
<b>参数：</b>任意<br>
<b>个数：</b>2或者3<br>
<b>功能：</b>如果第一个参数不为null则返回第一个参数（如果有三个参数，则返回第二个），否则返回第二个参数（如果有三个参数，则返回第三个）（第一次调用StcRef且所引用的函数未执行时，返回为null，或用(a)|(b)去匹配字符串"a"时，第二个捕获组返回null）<br>
<hr>
<p>
<b>函数：Iif</b><br>
<b>参数：</b>任意<br>
<b>个数：</b>4<br>
<b>功能：</b>如果第一个参数和第二个参数相等，则返回第三个参数，否则返回第四个参数。该方法经过特殊处理，未返回的那个参数如果是Seq之类的，则不受影响<br>
<hr>
<p>
<b>函数：Case</b><br>
<b>参数：</b>任意<br>
<b>个数：</b>3个或以上<br>
<b>功能：</b>Iif的增强版，如果第一个参数等于第二个，则返回第三个参数，如果第一个参数等于第四个，则返回第五个参数……如果第一个参数等于第2n个，则返回第2n+1个参数，如果都不匹配，并且参数个数是奇数，则返回空，否则返回最后一个参数<br>
该函数从左至右测试各个参数，一旦匹配上则停止，将不会对剩下的参数产生任何影响，即使它是一个像Seq之类的动态参数<br>
<hr>
<p>
<b>函数：Format</b><br>
<b>参数：</b>第一个为字符串，之后任意<br>
<b>个数：</b>大于等于1<br>
<b>功能：</b>格式化字符串，参数String.format(String format, Object... args)(注意，第一个参数不需要引号，如果要传入数字，请先用Add转换为整数或小数)<br>
例：1、$Format(%f,$Add(3.4))<br>2、$Format(%d,$Add(34))<br>
<hr>
<p>
<b>函数：Lower</b><br>
<b>参数：</b>任意非null值(如果不是字符串，先转换为字符串)<br>
<b>个数：</b>1<br>
<b>功能：</b>字符串中的英文转换为小写<br>
<hr>
<p>
<b>函数：Upper</b><br>
<b>参数：</b>任意非null值(如果不是字符串，先转换为字符串)<br>
<b>个数：</b>1<br>
<b>功能：</b>字符串中的英文转换为大写<br>
<hr>
<p>
<b>函数：AbsRow</b><br>
<b>参数：</b>无<br>
<b>个数：</b>无<br>
<b>功能：</b>返回当前匹配的绝对序号（注意跟序列Seq的区别）<br>
<hr>
<p>
<b>函数：空</b><br>
<b>参数：</b>整数或字符串<br>
<b>个数：</b>1<br>
<b>功能：</b>返回对应的捕获组内容（支持命名捕获组，需JAVA 1.7或以上）<br>
<hr>
<p>
<b>函数：Ref</b><br>
<b>参数：</b>整数（从左住右，函数的$出现的位置，从1开始）或临时别名（非纯数字的字符串）初始化时完成引用绑定，参数使用AbsRow可能出错(此时AbsRow为上次匹配个数)<br>
<b>个数：</b>1<br>
<b>功能：</b>动态引用，返回引用的函数的动态值（如果是Seq，则会取其下一个值，消耗一个序列值，StcRef仍会取到原来的值）<br>
<hr>
<p>
<b>函数：StcRef</b><br>
<b>参数：</b>同Ref<br>
<b>个数：</b>1<br>
<b>功能：</b>静态引用，返回引用的函数当时的值（如果是Seq，仍会取到原来的值，不消耗序列值）<br>
<hr>
<p>
<b>函数：Seq</b><br>
<b>参数：</b>数字（可以是动态参数，如Seq,AbsRow）<br>
<b>个数：</b>2或者3<br>
<b>返回值：</b><br>初始值(当前)+步增值(当前)*（调用次数-1），返回值类型取决于当前参数，如果传入参数的取值一会是整数一会是小数，那么此函数的返回值也可能随之变化<br>
<b>参数说明：</b>1、初始值  2、步增值  3、重置阈值（可选）<br>
<b>功能：</b>序列生成器，初始化或重置时，根据参数得到二个或三个当前值（初始值、步增值、重置阈值），替换原当前值，调用次数置0。若设置了重置阈值，下一个取值如果会大于或小于（视步增值的正负，判定时请注意部分小数不能准确表示的问题）阈值，则重置此序列，参数只在第一次和重置时才被读取<br>
<hr>
<p>
<b>函数：Repeat</b><br>
<b>参数：</b>第1个任意，第2个和第3个为数字<br>
<b>个数：</b>2或者3<br>
<b>参数说明：</b>1、需要重复的字符串  2、重复次数  3、最大长度（可选）<br>
<b>功能：</b>生成一个将传入字符串重复N次的新字符串，如果超过了指定的最大长度，则超出部分将被丢弃。指定了最大长度时，重复次数可为负数，此时将一直重复直至达到最大长度，参见DynRepeat<br>
<hr>
<p>
<b>函数：DynRepeat</b><br>
<b>参数：</b>第1个任意（可以是动态参数，如Seq,AbsRow），第2个和第3个为数字<br>
<b>个数：</b>2或者3<br>
<b>参数说明：</b>1、需要重复的字符串（可以是动态参数）  2、重复次数  3、最大长度（可选）<br>
<b>功能：</b>参见Repeat，区别在于，每次复制时，此函数都会重新读取第一个参数<br>
举例对比：<br>
$Repeat($Seq(1,1),5)会得到'11111'<br>
$DynRepeat($Seq(1,1),5)会得到'12345'<br>
<br>
<hr>
</BODY>
</HTML>